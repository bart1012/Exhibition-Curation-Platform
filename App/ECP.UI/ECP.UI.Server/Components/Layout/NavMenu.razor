@using MudBlazor;
@inject NavigationManager Navigation
@implements IDisposable

    <MudAppBar Elevation="0" Color="Color.Transparent">
    @if (!_drawerOpen)
    {
    <MudIconButton Icon="@Icons.Material.Filled.Menu"
    Color="Color.Inherit"
    Size="Size.Large"
    Edge="Edge.Start"
    OnClick="@DrawerToggle" />
    }
    <MudSpacer />
    <MudIconButton Icon="@Icons.Material.Filled.MoreVert"
    Color="Color.Inherit"
    Edge="Edge.End" />
    </MudAppBar>
    <MudDrawer @bind-Open="_drawerOpen" Elevation="2" Class="mud-drawer-fixed" Style="z-index:5000">
    <MudDrawerHeader Class="pa-0">
        <MudIconButton Icon="@Icons.Material.Filled.ArrowBack"
                       Color="Color.Default"
                       DropShadow="false"
                       Edge="Edge.Start"
                       Size="Size.Small"
                       OnClick="@DrawerToggle" 
                       Style="padding-left: 2rem; border-bottom: 1px solid grey; justify-content: start; color: black; width: 100%; height: 100%; border-radius: 0;"/>
    </MudDrawerHeader>
    <MudNavMenu Color="Color.Dark">
        <MudNavLink Color="Color.Dark" Href="/" Match="NavLinkMatch.All">Explore</MudNavLink>
        <MudNavLink Href="/collections">My Collections</MudNavLink>
        <MudNavLink Href="/search">Search</MudNavLink>
    </MudNavMenu>
</MudDrawer>

<style>
    .mud-icon-size-medium{
        fill: black !important;
    }
</style>
 


@code{
    private bool _drawerOpen = false;

    protected override void OnInitialized()
    {
        Navigation.LocationChanged += OnLocationChanged;
    }

    private void OnLocationChanged(object? sender, LocationChangedEventArgs e)
    {
        _drawerOpen = false;
        StateHasChanged();
    }

    private void DrawerToggle()
    {
        _drawerOpen = !_drawerOpen; // Fixed this too!
    }

    public void Dispose()
    {
        Navigation.LocationChanged -= OnLocationChanged;
    }
}