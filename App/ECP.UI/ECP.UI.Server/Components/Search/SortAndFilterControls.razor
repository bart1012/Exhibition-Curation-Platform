@using ECP.UI.Server.Models

<div class="search-controls">
    <div class="sort-controls">
        <MudMenu FullWidth="true"
                 Style="border:none; display: block; height: 100%;"
                 AnchorOrigin="Origin.BottomLeft"
                 aria-label="Sort options">
            <ActivatorContent>
                <MudButton aria-haspopup="true"
                           aria-expanded="false" 
                           aria-label="@($"Current sort: {SortText}")"
                           Ripple="false" Class="no-hover px-0 pt-0 sort-btn" 
                           Style="min-width: auto; border:none; display:flex; justify-content: start;">
                    @SortText
                </MudButton>
            </ActivatorContent>
            <ChildContent>
                <MudMenuItem OnClick="() => OnSortFieldChanged.InvokeAsync(0)">Creation Date</MudMenuItem>
                <MudMenuItem OnClick="() => OnSortFieldChanged.InvokeAsync(1)">Alphabetically</MudMenuItem>
            </ChildContent>
        </MudMenu>

        <MudToggleIconButton Toggled="IsDescending"
                             ToggledChanged="@((bool newToggled) => OnSortDirectionChanged.InvokeAsync(newToggled))"
                             Icon="@Icons.Material.Filled.ArrowUpward"
                             Color="@Color.Dark"
                             Size="Size.Small"
                             Ripple="false"
                             ToggledIcon="@Icons.Material.Filled.ArrowDownward"
                             ToggledColor="@Color.Dark"
                             Class="no-hover rounded-r-xl px-1 pt-0 pb-0 sort-direction-btn"
                             aria-label="@(IsDescending ? "Toggle ascending" : "Toggle descending")"
                             Style="border:none; display: flex; align-items: start;" />
    </div>
    <MudButton Ripple="false" 
        Style="border:none; display: flex; align-items: start;" 
        OnClick="() => OnFilterClick.InvokeAsync()" 
        Variant="Variant.Outlined"
        aria-label="Filter"
        Color="Color.Dark" EndIcon="@Icons.Material.Filled.FilterList" 
        Class="no-hover pt-0 rounded-pill">
        Filter
    </MudButton>
</div>
@code {
    [Parameter]
    public EventCallback OnFilterClick { get; set; }
    [Parameter]
    public EventCallback<bool> OnSortDirectionChanged { get; set; }
    [Parameter]
    public EventCallback<int> OnSortFieldChanged { get; set; }
    [Parameter]
    public string? SortText { get; set; }
    [Parameter]
    public bool IsDescending { get; set; }
}
